<%# Eliminamos el margin-left y el max-width manual, ya que el layout se encarga de eso %>
<div style="font-family: sans-serif;">
  
  <header style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
    <div>
      <h1 style="margin: 0; font-size: 1.8rem; color: #1e293b;">‚öôÔ∏è Motor de Reglas</h1>
      <p style="margin: 5px 0 0; color: #64748b; font-size: 0.9rem;">Gestiona la inteligencia de categorizaci√≥n jer√°rquica.</p>
    </div>
    <%= link_to "‚ûï Nueva Regla", new_category_rule_path, 
        style: "background: #3b82f6; color: white; padding: 10px 20px; border-radius: 8px; text-decoration: none; font-weight: 600; box-shadow: 0 4px 6px -1px rgba(59, 130, 246, 0.5);" %>
  </header>

  <%# Contenedor con scroll horizontal interno por seguridad %>
  <div style="width: 100%; overflow-x: auto; background: white; border-radius: 12px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); border: 1px solid #e2e8f0;">
    <table style="width: 100%; border-collapse: collapse; min-width: 800px;">
      <thead>
        <tr style="background: #f8fafc; text-align: left;">
          <th style="padding: 16px; border-bottom: 2px solid #f1f5f9; color: #475569; font-size: 0.85rem; text-transform: uppercase;">Nombre / Jerarqu√≠a</th>
          <th style="padding: 16px; border-bottom: 2px solid #f1f5f9; color: #475569; font-size: 0.85rem; text-transform: uppercase;">Padre</th>
          <th style="padding: 16px; border-bottom: 2px solid #f1f5f9; color: #475569; font-size: 0.85rem; text-transform: uppercase;">Patr√≥n (Regex)</th>
          <th style="padding: 16px; border-bottom: 2px solid #f1f5f9; color: #475569; font-size: 0.85rem; text-transform: uppercase; text-align: center;">Prioridad</th>
          <th style="padding: 16px; border-bottom: 2px solid #f1f5f9; color: #475569; font-size: 0.85rem; text-transform: uppercase; text-align: center;">Acciones</th>
        </tr>
      </thead>
      <tbody>
        <% @category_rules.order(parent_id: :asc, priority: :desc).each do |rule| %>
          <tr style="border-bottom: 1px solid #f1f5f9; transition: background 0.2s;" onmouseover="this.style.backgroundColor='#f8fafc'" onmouseout="this.style.backgroundColor='transparent'">
            <td style="padding: 16px;">
              <div style="display: flex; align-items: center; gap: 8px;">
                <strong style="color: #1e293b;"><%= rule.name %></strong>
                <% if rule.parent_id.nil? %>
                  <span style="font-size: 0.65rem; background: #dcfce7; color: #166534; padding: 2px 8px; border-radius: 20px; font-weight: bold; letter-spacing: 0.05em;">RA√çZ</span>
                <% else %>
                  <span style="font-size: 0.65rem; background: #f1f5f9; color: #64748b; padding: 2px 8px; border-radius: 20px;">HIJA</span>
                <% end %>
              </div>
            </td>
            <td style="padding: 16px; color: #64748b; font-size: 0.9rem;">
              <%= rule.parent&.name || "‚Äî" %>
            </td>
            <td style="padding: 16px;">
              <code style="background: #fef2f2; color: #dc2626; padding: 4px 8px; border-radius: 4px; font-size: 0.85rem; border: 1px solid #fee2e2;">
                <%= rule.pattern %>
              </code>
            </td>
            <td style="padding: 16px; text-align: center; font-weight: 600; color: #475569;">
              <%= rule.priority %>
            </td>
            <td style="padding: 16px; text-align: center;">
              <div style="display: flex; justify-content: center; gap: 15px;">
                <%= link_to "‚úèÔ∏è", edit_category_rule_path(rule), title: "Editar", style: "text-decoration: none; font-size: 1.1rem;" %>
                <%= button_to rule, method: :delete, data: { confirm: "¬øEliminar esta regla?" }, 
                    style: "background: none; border: none; cursor: pointer; padding: 0; font-size: 1.1rem;", title: "Eliminar" do %>
                  üóëÔ∏è
                <% end %>
              </div>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
</div>
